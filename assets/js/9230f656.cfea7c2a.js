"use strict";(self.webpackChunkyogeexu_docs=self.webpackChunkyogeexu_docs||[]).push([[6303],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>c});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),u=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=u(e.components);return r.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},i=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),i=u(n),c=a,k=i["".concat(p,".").concat(c)]||i[c]||m[c]||l;return n?r.createElement(k,s(s({ref:t},d),{},{components:n})):r.createElement(k,s({ref:t},d))}));function c(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,s=new Array(l);s[0]=i;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var u=2;u<l;u++)s[u]=n[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}i.displayName="MDXCreateElement"},9595:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>u});var r=n(7462),a=(n(7294),n(3905));const l={},s="XMLHttpRequest \u4ecb\u7ecd",o={unversionedId:"webs/web/request/XMLHttpRequest",id:"webs/web/request/XMLHttpRequest",title:"XMLHttpRequest \u4ecb\u7ecd",description:"1.png",source:"@site/docs/webs/web/request/XMLHttpRequest.md",sourceDirName:"webs/web/request",slug:"/webs/web/request/XMLHttpRequest",permalink:"/yogeexu-docs/webs/web/request/XMLHttpRequest",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"myAutogeneratedSidebar",previous:{title:"HTTP",permalink:"/yogeexu-docs/webs/web/request/HTTP"},next:{title:"axios",permalink:"/yogeexu-docs/webs/web/request/axios"}},p={},u=[{value:"XMLHttpRequest \u7684\u540c\u6b65\u548c\u5f02\u6b65",id:"xmlhttprequest-\u7684\u540c\u6b65\u548c\u5f02\u6b65",level:2},{value:"XMLHttpRequest \u5c5e\u6027\u4ecb\u7ecd",id:"xmlhttprequest-\u5c5e\u6027\u4ecb\u7ecd",level:3},{value:"xhr \u53ea\u8bfb\u5c5e\u6027",id:"xhr-\u53ea\u8bfb\u5c5e\u6027",level:3},{value:"<strong>xhr.upload</strong> \u5bf9\u8c61\u4e0a\u4e8b\u4ef6\u76d1\u542c\u5668",id:"xhrupload-\u5bf9\u8c61\u4e0a\u4e8b\u4ef6\u76d1\u542c\u5668",level:3},{value:"xhr \u53ef\u5b9a\u4e49\u5c5e\u6027",id:"xhr-\u53ef\u5b9a\u4e49\u5c5e\u6027",level:3},{value:"\u5168\u5c40\u6587\u6863\u73af\u5883(document environment)",id:"\u5168\u5c40\u6587\u6863\u73af\u5883document-environment",level:3},{value:"\u975e\u6807\u51c6\u5c5e\u6027",id:"\u975e\u6807\u51c6\u5c5e\u6027",level:3},{value:"xhr \u65b9\u6cd5\u8bf4\u660e",id:"xhr-\u65b9\u6cd5\u8bf4\u660e",level:3},{value:"\u4e8b\u4ef6\u5904\u7406\u5668",id:"\u4e8b\u4ef6\u5904\u7406\u5668",level:3}],d={toc:u};function m(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"xmlhttprequest-\u4ecb\u7ecd"},"XMLHttpRequest \u4ecb\u7ecd"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://pic.jitudisk.com/public/2022/06/28/f1abc4fe64a55.png"},(0,a.kt)("img",{parentName:"a",src:"https://pic.jitudisk.com/public/2022/06/28/f1abc4fe64a55.png",alt:"1.png"}))),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://mmbiz.qpic.cn/mmbiz_png/crZicD08ZoNcbvX53FsuAfjFDhdTtHkFOAvnnb5jDhicu27RHW3icKdJffqiaBgXMVxiaZqTibYvlJ8RJZVr4sjWBPZQ/0?wx_fmt=png",alt:"XMLHttpRequest"})),(0,a.kt)("p",null,"XMLHttpRequest\uff08XHR\uff09\u5bf9\u8c61\u7528\u4e8e\u4e0e\u670d\u52a1\u5668\u4ea4\u4e92, \u901a\u8fc7 XMLHttpRequest \u53ef\u4ee5\u5728\u4e0d\u5237\u65b0\u9875\u9762\u7684\u60c5\u51b5\u4e0b\u8bf7\u6c42\u7279\u5b9a URL\uff0c\u83b7\u53d6\u6570\u636e\n\u8fd9\u5141\u8bb8\u7f51\u9875\u5728\u4e0d\u5f71\u54cd\u7528\u6237\u64cd\u4f5c\u7684\u60c5\u51b5\u4e0b\uff0c\u66f4\u65b0\u9875\u9762\u7684\u5c40\u90e8\u5185\u5bb9\uff0cXMLHttpRequest \u53ef\u4ee5\u7528\u4e8e\u83b7\u53d6\u4efb\u4f55\u7c7b\u578b\u7684\u6570\u636e\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f XML\n\u5b83\u751a\u81f3\u652f\u6301 HTTP \u4ee5\u5916\u7684\u534f\u8bae\uff08\u5305\u62ec file:// \u548c FTP\uff09\uff0c\u53ef\u80fd\u53d7\u5230\u66f4\u591a\u51fa\u4e8e\u5b89\u5168\u7b49\u539f\u56e0\u7684\u9650\u5236\uff0c\u8be5\u9020\u51fd\u6570\u7528\u4e8e\u521d\u59cb\u5316\u4e00\u4e2a XMLHttpRequest \u5b9e\u4f8b\u5bf9\u8c61\uff0c\n\u5728\u8c03\u7528\u4e0b\u5217\u4efb\u4f55\u5176\u4ed6\u65b9\u6cd5\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u8c03\u7528\u8be5\u6784\u9020\u51fd\u6570\uff0c\u6216\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\uff0c\u5f97\u5230\u4e00\u4e2a\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u7ee7\u627f\u4e86 XMLHttpReuqestEventTarget \u548c EventTarger \u7684\u5c5e\u6027\uff0c\n\u5728\u8c03\u7528 send() \u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u4e4b\u524d\uff0c\u5fc5\u987b\u81f3\u5c11\u8c03\u7528 open() \u6765\u521d\u59cb\u5316\u8fd9\u4e2a\u5bf9\u8c61"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest"},"XMLHttpRequest"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// \u5f88\u591a\u5c5e\u6027\u53ef\u80fd\u53ea\u80fd\u5728\u8c03\u7528 xhr.open() \u65b9\u6cd5\u4e4b\u540e\uff0c\u4e14\u5728\u8c03\u7528 xhr.send() \u65b9\u6cd5\u4e4b\u524d\u8bbe\u7f6e\n// \u6240\u4ee5\u628a xhr.open() \u5199\u5728\u524d\u9762\u6bd4\u8f83\u53ef\u9760\uff0c\u907f\u514d\u51fa\u73b0\u4e00\u4e9b\u9519\u8bef\nconst url = 'https://xxx/api/list'\nconst xhr = new XMLHttpRequest()\nxhr.open('GET', url, true) // true \u8868\u793a \u5f02\u6b65\u8bf7\u6c42\n\nxhr.onload = function(res) {\n console.log(res)\n}\n\nxhr.send(null)\n")),(0,a.kt)("h2",{id:"xmlhttprequest-\u7684\u540c\u6b65\u548c\u5f02\u6b65"},"XMLHttpRequest \u7684\u540c\u6b65\u548c\u5f02\u6b65"),(0,a.kt)("p",null,"XMLHttpRequest \u652f\u6301\u540c\u6b65\u548c\u5f02\u6b65\u8bf7\u6c42\uff0c\u8fd9\u70b9\u6bd4\u8f83\u91cd\u8981\n\u4f46\u662f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u51fa\u4e8e\u6027\u80fd\u539f\u56e0\uff0c\u5f02\u6b65\u8bf7\u6c42\u5e94\u4f18\u5148\u4e8e\u540c\u6b65\u8bf7\u6c42\uff0c\u540c\u6b65\u8bf7\u6c42\u963b\u6b62\u4ee3\u7801\u7684\u6267\u884c\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5c4f\u5e55\u4e0a\u51fa\u73b0 '\u51bb\u7ed3' \u548c \u65e0\u54cd\u5e94 \u7684\u7528\u6237\u4f53\u9a8c"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5177\u4f53\u67e5\u770b\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests"},"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests"},"XMLHttpRequest-\u540c\u6b65\u548c\u5f02\u6b65\u8bf7\u6c42"))),(0,a.kt)("h3",{id:"xmlhttprequest-\u5c5e\u6027\u4ecb\u7ecd"},"XMLHttpRequest \u5c5e\u6027\u4ecb\u7ecd"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"readyState"),(0,a.kt)("li",{parentName:"ul"},"response"),(0,a.kt)("li",{parentName:"ul"},"responseType"),(0,a.kt)("li",{parentName:"ul"},"responseText"),(0,a.kt)("li",{parentName:"ul"},"responseURL"),(0,a.kt)("li",{parentName:"ul"},"responseXML"),(0,a.kt)("li",{parentName:"ul"},"status"),(0,a.kt)("li",{parentName:"ul"},"statusText"),(0,a.kt)("li",{parentName:"ul"},"timeout"),(0,a.kt)("li",{parentName:"ul"},"upload"),(0,a.kt)("li",{parentName:"ul"},"withCredentials"),(0,a.kt)("li",{parentName:"ul"},"chanel"),(0,a.kt)("li",{parentName:"ul"},"mozAnon"),(0,a.kt)("li",{parentName:"ul"},"mozBackgroundRequest"),(0,a.kt)("li",{parentName:"ul"},"mozSystem"),(0,a.kt)("li",{parentName:"ul"},"msCaching")),(0,a.kt)("h3",{id:"xhr-\u53ea\u8bfb\u5c5e\u6027"},"xhr \u53ea\u8bfb\u5c5e\u6027"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"readyState")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.readyState\n/* \u8fd4\u56de\u4e00\u4e2a XMLHttpRequest \u4ee3\u7406\u5f53\u524d\u6240\u5904\u7684\u72b6\u6001\u3002\u4e00\u4e2a XHR \u4ee3\u7406\u603b\u662f\u5904\u4e8e\u4e0b\u5217\u72b6\u6001\u4e2d\u7684\u4e00\u4e2a\n\u53ef\u901a\u8fc7 xhr.onreadystatechange \u65b9\u6cd5 \u6765\u76d1\u542c\uff0creadyState \u53d8\u5316\n*/\n\n")),(0,a.kt)("p",null,"UNSENT | OPENED | LOADING | HEADERS_RECEIVED | UDONE \u5728 XMLHttpReuqest \u7684\u539f\u578b\u4e0a\u53ef\u4ee5\u67e5\u770b\u5230"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"console.log(XMLHttpReuqest, 'XMLHttpReuqest--')\nconsole.log(XMLHttpReuqest.prototype, 'XMLHttpReuqest-prototype-')\nconsole.log(XMLHttpReuqest.UNSENT, 'XMLHttpReuqest.UNSENT-') // 0\nconsole.log(XMLHttpReuqest.OPENED, 'XMLHttpReuqest.OPENED-') // 1\nconsole.log(XMLHttpReuqest.HEADERS_RECEIVED, 'XMLHttpReuqest.HEADERS_RECEIVED-') // 2\nconsole.log(XMLHttpReuqest.LOADING, 'XMLHttpReuqest.LOADING-') // 3\nconsole.log(XMLHttpReuqest.DONE, 'XMLHttpReuqest.OPENED-') // 4\nconst xhr = new XMLHttpRequest()\nconsole.log(xhr, 'xhr--')\nconsole.log(xhr.UNSENT) // 0\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"readyState")," \u72b6\u6001\u53c2\u8003\u53ca\u8bf4\u660e\n\u72b6\u6001\u7801 | \u72b6\u6001 | \u63cf\u8ff0\n| - | - | - |\n0 | UNSENT | XMLHttpRequest \u4ee3\u7406\u5df2\u88ab\u521b\u5efa\uff0c \u4f46\u5c1a\u672a\u8c03\u7528 open() \u65b9\u6cd5\n1 | OPENED | xhr.open() \u65b9\u6cd5\u5df2\u7ecf\u8c03\u7528\uff0c\u5728\u8fd9\u4e2a\u72b6\u6001\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7  setRequestHeader() \u65b9\u6cd5\u6765\u8bbe\u7f6e\u8bf7\u6c42\u7684\u5934\u90e8\uff0c\u7136\u540e\u8c03\u7528 xhr.send() \u65b9\u6cd5\u6765\u53d1\u8d77\u8bf7\u6c42\uff0c\u6ce8\u610f setRequestHeader() \u9700\u8981\u5728 xhr.open() \u548c xhr.send \u4e4b\u524d \u8bbe\u7f6e\n2 | HEADERS_RECEIVED | send() \u65b9\u6cd5\u5df2\u7ecf\u88ab\u8c03\u7528\uff0c\u54cd\u5e94\u5934\u5df2\u7ecf\u88ab\u63a5\u6536\n3 | LOADING | \u8bf7\u6c42\u6b63\u5728\u8fdb\u884c responseText \u5c5e\u6027\u5df2\u7ecf\u8fd4\u56de\u90e8\u5206\u6570\u636e\n4 | DONE | \u8bf7\u6c42\u5b8c\u6210\uff0c\u8fd4\u56de\u5168\u90e8\u7684\u6570\u636e"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"response")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.responese\n/* \u8fd4\u56de\u54cd\u5e94\u7684\u6b63\u6587\n\u8fd4\u56de\u7684\u7c7b\u578b\u4e3a\uff1aArrayBuffer\u3001Blob \u3001 Document\u3001JavaScript Object \u6216 DOMString \u4e2d\u7684\u4e00\u4e2a\n\u5177\u4f53\u8fd4\u56de\u54ea\u79cd\u7c7b\u578b\u53d6\u51b3\u4e8e responseType \u7684\u5b9a\u4e49\uff0c\u5982 \u4e0b\u8f7d\u6587\u4ef6\u65f6\uff1axhr.responseType=\'blob\'\n\u6ce8\u610f\uff1a\n    responseType \u7684\u8bbe\u7f6e\uff0c\u8981\u5728\u8c03\u7528 xhr.open() \u521d\u59cb\u5316\u8bf7\u6c42\u4e4b\u540e\u8c03\u7528\n \u5e76\u4e14\u8981\u5728\u8c03\u7528 xhr.send() \u53d1\u9001\u8bf7\u6c42\u5230\u670d\u52a1\u5668\u4e4b\u524d\u8c03\u7528\n--------------------------------------------------------------------------------\n\u5982\u679c\u8bf7\u6c42 \u5c1a\u672a\u5b8c\u6210 \u6216 \u672a\u6210\u529f\uff0c\u5219\u53d6\u503c\u662f null\n\u5f53 \u8bfb\u53d6\u6587\u672c \u6570\u636e\u65f6\uff0c\u5982\u679c\u5c06 responseType \u7684\u503c\u8bbe\u7f6e\u6210 "text" \u6216\u7a7a\u5b57\u7b26\u4e32\uff08""\uff09\n\u5f53\u8bf7\u6c42\u72b6\u6001 readyState \u5904\u4e8e 3 LOADING \u65f6\uff0cresponse \u5305\u542b\u5230\u76ee\u524d\u4e3a\u6b62\u8be5\u8bf7\u6c42\u5df2\u7ecf\u53d6\u5f97\u7684\u5185\u5bb9\n\u5f53\u8bf7\u6c42\u72b6\u6001 readyState \u53d8\u6210 4 DONE \u65f6\u5c31\u4f1a\u83b7\u53d6 response\uff0c\n\u53ef\u4ee5\u5728 onreadystatechange\u65b9\u6cd5\u4e2d\uff0c\u5c06\u5176\u4f20\u9012\u7ed9 callback(xhr.response) \u56de\u8c03\u51fd\u6570 \n*/  \n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const url = 'https://xxx.com/xxx.html'\nfunction callback(res) {\n console.log(res)\n}\nfunction getContent(callback) {\n const xhr = new XMLHttpRequest()\n xhr.open('GET', url)\n xhr.onreadystatechange = function() {\n  if(xhr.readyState === 4) {\n   callback && callback(xhr.response)\n  }\n }\n xhr.send()\n}\ngetContent(callback)\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"responseText")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/conflicting/Web/JavaScript/Reference/Global_Objects/String_6fa58bba0570d663099f0ae7ae8883ab"},"DOMString\u8bf4\u660e"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.responseText\n/* \u53d6\u503c\uff1aDOMString\n\u8bf7\u6c42\u88ab\u53d1\u9001\u540e\uff0c\u4ece\u670d\u52a1\u5668\u7aef\u8fd4\u56de\u7684\u7eaf\u6587\u672c\u7684\u503c\n\u5f53 DOMString \u4e3a null (\u5373 responseText: null) \u65f6\uff0c\u8868\u793a\u8bf7\u6c42\u5931\u8d25\u4e86\n\u5f53 DOMString \u4e3a "" (\u5373 responseText: "") \u65f6\uff0c\u8868\u793a\u8bf7\u6c42\u4e3a\u8c03\u7528 xhr.send()\n\u5728\u53d1\u9001\u8bf7\u6c42\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5c3d\u7ba1\u8bf7\u6c42\u672a\u7ed3\u675f\uff0cresponseText \u7684\u8fd4\u56de\u503c\u662f\u5f53\u524d\u4ece\u540e\u7aef\u8fd4\u56de\u7684\u5185\u5bb9\n\u53ef\u4ee5\u5728 onreadystatechange \u548c onprogress \u4e2d\u6253\u5370 \u5b9e\u4f8b\u7684 xhr \u67e5\u770b\u65e5\u5fd7\n\u5f53 \u8bf7\u6c42\u72b6\u6001 reayState\uff0c\u53d8\u4e3a 4 - DONE \u65f6\uff0c\u4e14 status - 200\u65f6\uff0cresponseText \u662f\u540e\u7aef\u8fd4\u56de\u7684\u5168\u90e8\u6570\u636e\n*/\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"responseURL")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.responseURL\n/*\u8fd4\u56de\u8bf7\u6c42\u54cd\u5e94\u7684 \u5e8f\u5217\u5316 URL\n\u5982\u679c URL \u5e26\u6709\u951a\u70b9\uff0cURL # \u540e\u9762\u7684\u5185\u5bb9\u4f1a\u88ab\u5220\u9664\n\u5982\u679c URL \u6709\u91cd\u5b9a\u5411\uff0cresponseURL \u7684\u503c\u4f1a\u662f\u91cd\u5b9a\u5411\u540e\u7684\u6700\u7ec8 URL\n*/\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"responseXML")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Document"},"Document\u63a5\u53e3"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.responseXML\n/*\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u8bf7\u6c42\u68c0\u7d22\u7684 HTML \u6216 XML \u7684 Document\n\u9ed8\u8ba4\u662f\u5f53\u4f5c "text/xml" \u6765\u89e3\u6790\uff0c\u53ef\u4ee5\u540c\u65f6\u5728 HTML \u548c XML \u4e2d\u5de5\u4f5c\n\u5982\u679c\u8bf7\u6c42\u672a\u6210\u529f\uff0c\u5c1a\u672a\u53d1\u9001\uff0c\u6216\u8005\u68c0\u7d22\u7684\u6570\u636e\u65e0\u6cd5\u6b63\u786e\u89e3\u6790\u4e3a XML \u6216 HTML\uff0c\u5219 responseXML \u7684\u503c\u4e3a null\nxhr.responseType \u8bbe\u7f6e\u4e3a "document"\u65f6\uff0c\u5e76\u4e14\u8bf7\u6c42\u5df2\u5f02\u6b65\u6267\u884c\u65f6\uff0c\u54cd\u5e94\u5c06\u88ab\u5f53\u4f5c "text/html" \u6765\u89e3\u6790\nxhr.responseType \u65e2\u4e0d\u662f "document" \u4e5f\u4e0d\u662f\u7a7a\u5b57\u7b26\u4e32\uff0c\u63a5\u6536\u7684\u6570\u636e\u5e94\u662f XML \u6216 HTML\n\n\u5982\u679c\u670d\u52a1\u5668\u6ca1\u6709\u660e\u786e\u6307\u51fa Content-Type \u5934\u662f "text/xml" \u8fd8\u662f "application/xml"\n\u53ef\u4ee5\u4f7f\u7528 xhr.overrideMimeType() \u5f3a\u5236 XMLHttpRequest \u89e3\u6790\u4e3a XML\n\nDocument \u4e2d\u5305\u542b\u4ece XMLHttpRequest \u4e2d\u6536\u5230\u7684 HTML \u8282\u70b9\u6216\u89e3\u6790\u540e\u7684 XML \u8282\u70b9\n\u4e5f\u53ef\u80fd\u662f\u5728\u6ca1\u6709\u6536\u5230\u4efb\u4f55\u6570\u636e\u6216\u6570\u636e\u7c7b\u578b\u9519\u8bef\u7684\u60c5\u51b5\u4e0b\u8fd4\u56de\u7684 null\n*/\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"status")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status"},"HTTP \u54cd\u5e94\u72b6\u6001\u7801"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.status\n/* \u8fd4\u56de\u4e86 XMLHttpRequest \u8bf7\u6c42\u54cd\u5e94\u4e2d\u7684\u6570\u5b57\u72b6\u6001\u7801\nstatus \u7684\u503c\u662f\u4e00\u4e2a\u65e0\u7b26\u53f7\u77ed\u6574\u578b\uff0c\u5728\u8bf7\u6c42\u5b8c\u6210\u524d\uff0cstatus \u7684\u503c\u4e3a 0\n\u5982\u679c XMLHttpRequest \u8bf7\u6c42\u51fa\u9519\uff0c\u6d4f\u89c8\u5668\u8fd4\u56de\u7684 status \u4e5f\u4e3a 0\nstatus \u7801\u662f\u6807\u51c6\u7684 HTTP \u54cd\u5e94\u72b6\u6001\u7801\nstatus 200 \u4ee3\u8868\u4e00\u4e2a\u6210\u529f\u7684\u8bf7\u6c42\n\u5982\u679c\u670d\u52a1\u5668\u54cd\u5e94\u4e2d\u6ca1\u6709\u660e\u786e\u6307\u5b9a status \u7801\uff0cXMLHttpRequest.status \u5c06\u4f1a\u9ed8\u8ba4\u4e3a 200\n*/\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const url = 'https://xxx.com/api/list'\nconst xhr = new XMLHttpRequest()\nxhr.open('GET', url, true)\nxhr.onprogress = function () {\n  console.log('LOADING', xhr.status)\n}\nxhr.onload = function () {\n  console.log('DONE', xhr.status);\n}\nxhr.send(null)\n\n/**\n * \u7ed3\u679c:\n * UNSENT\uff08\u672a\u53d1\u9001\uff090\n * OPENED\uff08\u5df2\u6253\u5f00\uff090\n * LOADING\uff08\u8f7d\u5165\u4e2d\uff09200\n * DONE\uff08\u5b8c\u6210\uff09200\n */\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"statusText")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.statusText\n/*\u8fd4\u56de\u4e86XMLHttpRequest \u8bf7\u6c42\u4e2d\uff0c\u7531\u670d\u52a1\u5668\u8fd4\u56de\u7684\u4e00\u4e2a DOMString \u7c7b\u578b\u7684\u6587\u672c\u4fe1\u606f\n\u8fd9\u5219\u4fe1\u606f\u4e2d\u4e5f\u5305\u542b\u4e86\u54cd\u5e94\u7684\u6570\u5b57\u72b6\u6001\u7801\n\u4e0d\u540c\u4e8e\u7528\u6570\u5b57\u6765\u8868\u793a xhr.status \u7684\u54cd\u5e94\u72b6\u6001\u7801\nxhr.statusText \u8fd9\u4e2a\u5c5e\u6027\u5305\u542b\u4e86\u8fd4\u56de\u72b6\u6001\u5bf9\u5e94\u7684\u6587\u672c\u4fe1\u606f\uff0c\u4f8b\u5982 "OK" \u6216\u662f "Not Found"\n\u5982\u679c\uff0c\u8bf7\u6c42\u72b6\u6001 xhr.readyState \u7684\u503c\u4e3a 0-UNSENT \u6216\u8005 1-OPENED\uff0c\u5219 xhr.statusText\u5c5e\u6027\u7684\u503c\u5c06\u4f1a\u662f\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\n\u5982\u679c\uff0c\u670d\u52a1\u5668\u672a\u660e\u786e\u6307\u5b9a\u4e00\u4e2a\u72b6\u6001\u6587\u672c\u4fe1\u606f\uff0c\u5219 xhr.statusText \u7684\u503c\u5c06\u4f1a\u88ab\u81ea\u52a8\u8d4b\u503c\u4e3a "OK"\n*/\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const url = 'https://xxx.com/api/list'\nconst xhr = new XMLHttpRequest()\nconsole.log('\u8bf7\u6c42\u72b6\u6001 readyState: 0-UNSENT', xhr.statusText)\n\nxhr.open('GET', url, true);\n console.log('\u8bf7\u6c42\u72b6\u6001 readyState: 1-OPENED', xhr.statusText)\nxhr.onprogress = function () {\n  console.log('\u8bf7\u6c42\u72b6\u6001 readyState: 3-LOADING', xhr.statusText)\n}\nxhr.onload = function () {\n  console.log('\u8bf7\u6c42\u72b6\u6001 readyState: 4-DONE', xhr.statusText)\n}\n\nxhr.send(null);\n\n/**\n * \u7ed3\u679c:\n * 0 UNSENT\n * 1 OPENED\n * 3 LOADING OK\n * 4 DONE OK\n */\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"upload")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequestEventTarget"},"XMLHttpRequestEventTarget"))),(0,a.kt)("p",null,"XMLHttpRequestEventTarget \u662f\u7528\u4e8e\u63cf\u8ff0\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u7684\u63a5\u53e3\uff0c\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u7528\u4e8e\u5904\u7406 XMLHttpRequest \u8bf7\u6c42\u4e8b\u4ef6\u7684\u5bf9\u8c61\u4e2d\u4f7f\u7528\u8be5\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0c\u5982 onload\u3001ontimeout"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.upload\n/* xhr.upload \u5c5e\u6027\u8fd4\u56de\u4e00\u4e2a XMLHttpRequestUpload \u5bf9\u8c61\uff0c\u7528\u6765\u8868\u793a\u4e0a\u4f20\u7684\u8fdb\u5ea6\n\n\u6ce8\u610f\uff1a\nXMLHttpRequestUpload \u662f\u4e0d\u900f\u660e\u7684\uff0c\u4f46\u662f\u4f5c\u4e3a\u4e00\u4e2a XMLHttpRequestEventTarget \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0c\n\u53ef\u4ee5\u901a\u8fc7\u5bf9\u5176\u7ed1\u5b9a\u4e8b\u4ef6\u6765\u8ffd\u8e2a\u5b83\u7684\u8fdb\u5ea6\uff0c\u5982 onprogress\n*/\n")),(0,a.kt)("h3",{id:"xhrupload-\u5bf9\u8c61\u4e0a\u4e8b\u4ef6\u76d1\u542c\u5668"},(0,a.kt)("strong",{parentName:"h3"},"xhr.upload")," \u5bf9\u8c61\u4e0a\u4e8b\u4ef6\u76d1\u542c\u5668"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u4e8b\u4ef6\u540d\u79f0"),(0,a.kt)("th",{parentName:"tr",align:null},"\u4e8b\u4ef6\u63cf\u8ff0"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"onloadstart"),(0,a.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u5f00\u59cb")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"onprogress"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6570\u636e\u4f20\u8f93\u8fdb\u884c\u4e2d")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"onabort"),(0,a.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u64cd\u4f5c\u7ec8\u6b62")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"onerror"),(0,a.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u5931\u8d25")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"onload"),(0,a.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u6210\u529f")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ontimeout"),(0,a.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u64cd\u4f5c\u5728\u7528\u6237\u89c4\u5b9a\u7684\u65f6\u95f4\u5185\u672a\u5b8c\u6210")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"onloadend"),(0,a.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u5b8c\u6210\uff08\u4e0d\u8bba\u6210\u529f\u4e0e\u5426\uff09")))),(0,a.kt)("h3",{id:"xhr-\u53ef\u5b9a\u4e49\u5c5e\u6027"},"xhr \u53ef\u5b9a\u4e49\u5c5e\u6027"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"timeout")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/timeout"},"\u5728\u5f02\u6b65\u8bf7\u6c42\u4e2d\u4f7f\u7528 timeout"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// \u5355\u4f4d\uff1a\u6beb\u79d2\nxhr.timeout = 5000\n\n/*\u65e0\u7b26\u53f7\u957f\u6574\u578b\u6570\uff0c\u4ee3\u8868\u7740\u4e00\u4e2a\u8bf7\u6c42\u5728\u88ab\u81ea\u52a8\u7ec8\u6b62\u524d\u6240\u6d88\u8017\u7684\u6beb\u79d2\u6570\n\u8bf7\u6c42\u7684\u6700\u5927\u8bf7\u6c42\u65f6\u95f4\uff08\u6beb\u79d2\uff09\uff0c\u82e5\u8d85\u51fa\u8be5\u65f6\u95f4\uff0c\u8bf7\u6c42\u4f1a\u81ea\u52a8\u7ec8\u6b62\uff0c\u9ed8\u8ba4\u503c\u4e3a 0\uff0c\u610f\u5473\u7740\u6ca1\u6709\u8d85\u65f6\n\u5f53\u8d85\u65f6\u53d1\u751f\u540e\uff0c\u4f1a\u89e6\u53d1 xhr.ontimeout \u4e8b\u4ef6\n\u5728 IE \u4e2d\uff0c\u8d85\u65f6\u5c5e\u6027\u53ef\u80fd\u53ea\u80fd\u5728\u8c03\u7528 xhr.open() \u65b9\u6cd5\u4e4b\u540e\u4e14\u5728\u8c03\u7528 send() \u65b9\u6cd5\u4e4b\u524d\u8bbe\u7f6e\n\u4e0d\u80fd\u5728 window \u4e2d\uff0c\u7ed9\u540c\u6b65\u8bf7\u6c42\u8bbe\u7f6e\u8d85\u65f6\n\n\u8d85\u65f6\u5e76\u4e0d\u5e94\u8be5\u7528\u5728\u5168\u5c40\u6587\u6863\u73af\u5883\u7684\u540c\u6b65 XMLHttpRequests \u8bf7\u6c42\u4e2d\n\u5426\u5219\u5c06\u4f1a\u629b\u51fa\u4e00\u4e2a InvalidAccessError(\u65e0\u6548\u8bbf\u95ee\u9519\u8bef) \u7c7b\u578b\u7684\u9519\u8bef\n*/\n")),(0,a.kt)("h3",{id:"\u5168\u5c40\u6587\u6863\u73af\u5883document-environment"},"\u5168\u5c40\u6587\u6863\u73af\u5883(document environment)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://html.spec.whatwg.org/multipage/webappapis.html#document-environment"},"document-environment\u7684 HTML \u89c4\u8303"),"\n\u5f53 JavaScript \u6240\u5904\u7684\u5168\u5c40\u73af\u5883\u4e3a window \u6216 iframe \u65f6\uff0c\u8fd9\u79cd\u73af\u5883\u88ab\u79f0\u4e3a\u5168\u5c40\u6587\u6863\u73af\u5883\n\u5168\u5c40\u7684\u6587\u6863\u73af\u5883\u5904\u4e8e\u6240\u6709\u73af\u5883\u7684\u9876\u5c42\uff0c\u5373\u6ca1\u6709\u66f4\u5916\u5c42\u7684\u73af\u5883")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const xhr = new XMLHttpRequest()\nconsole.log(xhr)\nxhr.open('GET', './source/test-180M.zip', true)\nxhr.responseType = 'blob'\nxhr.addEventListener('readystatechange', () => {\n console.log('\u8bf7\u6c42\u72b6\u6001\u53d1\u751f\u53d8\u5316~')\n console.log(xhr)\n})\nxhr.addEventListener('timeout', () => {\n console.log('\u7f51\u7edc\u8bf7\u6c42\u8d85\u65f6~')\n console.log(xhr)\n console.log('-------------------')\n console.log(alert('\u7f51\u7edc\u8bf7\u6c42\u8d85\u65f6'))\n})\nxhr.addEventListener('load', () => {\n console.log('\u8bf7\u6c42\u5b8c\u6210\uff1axhr-', xhr)\n})\nxhr.timeout = 200\nxhr.send(null)\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"responseType")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/responseType"},"responseType\u53c2\u8003"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.responseType = 'blob'\n/* \u54cd\u5e94\u7c7b\u578b \u662f\u4e00\u4e2a\u679a\u4e3e\u5b57\u7b26\u4e32\u503c\uff0c\u7528\u4e8e\u6307\u5b9a\u54cd\u5e94\u4e2d\u5305\u542b\u7684\u6570\u636e\u7c7b\u578b\n\u5982\u679c\u5c06 responseType \u7684\u503c\u8bbe\u7f6e\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u5219\u4f1a\u4f7f\u7528 text \u4f5c\u4e3a\u9ed8\u8ba4\u503c\n\u53ef\u5b9a\u4e49\u7c7b\u578b: '' | arraybuffer | blob | document | json | text | ms-stream */\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"withCredentials")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.withCredentials\n/* Boolean \u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\uff1afalse\n\u8868\u793a\u662f\u5426\u5e94\u4f7f\u7528 cookie\u3001Authorization Headers (\u5934\u90e8\u6388\u6743) \u6216\u8005 TLS \u5ba2\u6237\u7aef\u8bc1\u4e66\u7b49\n\u5176\u5b83\u5ba2\u6237\u7aef\u8bc1\u4e66\u6216\u51ed\u636e\u8fdb\u884c\u8de8\u7ad9\u70b9\uff08cross-site Access-Control\uff09\u8bbf\u95ee\u63a7\u5236\u8bf7\u6c42\n*/\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"1 \u6c38\u8fdc\u4e0d\u4f1a\u5f71\u54cd\u5230\u540c\u7ad9\u70b9\u7684\u8bf7\u6c42\uff0c\u5728\u540c\u4e00\u4e2a\u7ad9\u70b9\u4e0b\u4f7f\u7528 withCredentials \u5c5e\u6027\u662f\u65e0\u6548\u7684\uff0c\u5bf9\u540c\u7ad9\u70b9\u8bf7\u6c42\u6ca1\u6709\u5f71\u54cd")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"2 \u8868\u793a\u662f\u5426\u5e94\u4f7f\u7528 cookie\u3001Authorization Headers (\u5934\u90e8\u6388\u6743) \u6216\u8005 TLS \u5ba2\u6237\u7aef\u8bc1\u4e66\u7b49\u5176\u5b83\u5ba2\u6237\u7aef\u8bc1\u4e66\u6216\u51ed\u636e\u8fdb\u884c\u8de8\u7ad9\u70b9\uff08cross-site Access-Control\uff09\u8bbf\u95ee\u63a7\u5236\u8bf7\u6c42")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"3 \u5728\u53d1\u9001\u5176\u5b83\u57df\u540d\u7ad9\u70b9\u4e0b\u7684 XMLHttpRequest \u8bf7\u6c42\u4e4b\u524d\uff0c\u672a\u8bbe\u7f6e withCredentials \u4e3a true\u65f6\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u5728\u5f53\u524d\u57df\u540d\u4e0b\u8bbe\u7f6e Cookie \u503c\uff0c\u800c\u5982\u679c\u901a\u8fc7\u8bbe\u7f6e withCredentials \u4e3a true \u83b7\u5f97\u7684\u7b2c\u4e09\u65b9 Cookies\u5c06\u4f1a\u4f9d\u65e7\u4eab\u53d7\u540c\u6e90\u7b56\u7565\uff0c\u56e0\u6b64\u4e0d\u80fd\u88ab\u901a\u8fc7 document.cookie \u6216\u8005\u4ece\u5934\u90e8\u76f8\u5e94\u8bf7\u6c42\u7684\u811a\u672c\u7b49\u8bbf\u95ee")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"4 \u4e0d\u540c\u7ad9\u70b9\u7684 XMLHttpRequest \u54cd\u5e94\uff0c\u4e0d\u7ba1\u5176\u81ea\u5df1\u7684\u7ad9\u70b9 Access-Control-Header \u8bbe\u7f6e\u4ec0\u4e48\u503c\uff0c\u90fd\u65e0\u6cd5\u4e3a\u5b83\u81ea\u8eab\u7ad9\u70b9\u8bbe\u7f6e Cookie \u503c\uff0c\u9664\u975e\u5b83\u5728\u8bf7\u6c42\u4e4b\u524d\u5c06 withCredentials \u8bbe\u4e3a true"))),(0,a.kt)("h3",{id:"\u975e\u6807\u51c6\u5c5e\u6027"},"\u975e\u6807\u51c6\u5c5e\u6027"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"channel")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.channel\n/* \u521b\u5efa\u8bf7\u6c42\u65f6 channel \u662f\u4e00\u4e2a\u88ab\u5bf9\u8c61\u4f7f\u7528\u7684 nsIChannel\n   \u5982\u679c\u7ba1\u9053\uff08channel\uff09\u8fd8\u6ca1\u88ab\u521b\u5efa\u7684\u8bdd\uff0c\u5b83\u7684\u503c\u662f null\n   \u5728\u4e00\u4e2a multi-part \u8bf7\u6c42\u6848\u4f8b\u4e2d\uff0c\u5b83\u662f\u521d\u59cb\u5316\u7684\u7ba1\u9053\uff0c\u4e0d\u662f multi-part \u8bf7\u6c42\u4e2d\u7684\u4e0d\u540c\u90e8\u5206 */\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"mozAnon")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"}," xhr.mozAnon\n/* \u5e03\u5c14\u7c7b\u578b\uff0c\u5982\u679c\u8fd9\u4e2a\u53d8\u91cf\u4e3a\u771f\uff0c\u5219\u8fd9\u6b21\u8bf7\u6c42\u5c06\u4e0d\u643a\u5e26 Cookies \u6216\u5934\u90e8\u8ba4\u8bc1\u4fe1\u606f\u6765\u53d1\u9001 */\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"mozBackgroundRequest")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.mozBackgroundRequest\n/* \u5e03\u5c14\u5bf9\u8c61\uff0c\u8868\u793a object \u662f\u5426\u4e3a\u540e\u53f0\u7684\u670d\u52a1\u8bf7\u6c42\n\u5982\u679c\u4e3a true\uff0c\u5219\u4e0d\u4f1a\u5c06\u4efb\u4f55\u52a0\u8f7d\u7ec4\u4e0e\u8bf7\u6c42\u5173\u8054\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5411\u7528\u6237\u663e\u793a\u5b89\u5168\u5bf9\u8bdd\u6846\n\u8bf7\u6c42\u5931\u8d25\u65f6\u901a\u5e38\u4f1a\u663e\u793a\u5b89\u5168\u5bf9\u8bdd\u6846\uff08\u4f8b\u5982\u8eab\u4efd\u9a8c\u8bc1\u6216\u9519\u8bef\u8bc1\u4e66\u901a\u77e5\uff09\n!!!\u6ce8\u610f\uff1a\n Web \u5185\u5bb9\u65e0\u6cd5\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002\u5b83\u9700\u8981\u63d0\u5347\u6743\u9650\u624d\u80fd\u8bbf\u95ee\n \u8be5\u5c5e\u6027\u5fc5\u987b\u5728\u8c03\u7528 open() \u4e4b\u524d\u8bbe\u7f6e */ \n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"mozSystem")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.mozSystem\n/* \u5e03\u5c14\u7c7b\u578b\uff0c\u5982\u679c\u5b83\u88ab\u8bbe\u7f6e\u4e3a true\uff0c\u90a3\u4e48\u5728\u8bf7\u6c42\u65f6\u5c31\u4e0d\u4f1a\u5f3a\u5236\u8981\u6c42\u6267\u884c\u540c\u6e90\u7b56\u7565\uff08Same Origin Policy\uff09*/\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"msCaching")," \u5c5e\u6027\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.msCaching\n/* \u6307\u5b9a\u4f7f\u7528 XMLHttpRequest \u4e0b\u8f7d\u7684\u6d41\u6570\u636e\u662f\u5426\u7f13\u5b58\u5230\u78c1\u76d8\n\u6ce8\u610f:\n \u6b64\u529f\u80fd\u662f\u975e\u6807\u51c6\u7684\uff0c\u4e0d\u5728\u6807\u51c6\u8f68\u9053\u4e0a\n \u4e0d\u8981\u5728\u9762\u5411 Web \u7684\u751f\u4ea7\u7ad9\u70b9\u4e0a\u4f7f\u7528\u5b83\uff1a\u5b83\u4e0d\u9002\u7528\u4e8e\u6bcf\u4e2a\u7528\u6237\n \u5b9e\u73b0\u4e4b\u95f4\u4e5f\u53ef\u80fd\u5b58\u5728\u5f88\u5927\u7684\u4e0d\u517c\u5bb9\u6027\uff0c\u5e76\u4e14\u884c\u4e3a\u53ef\u80fd\u4f1a\u5728\u672a\u6765\u53d1\u751f\u53d8\u5316 */\n")),(0,a.kt)("h3",{id:"xhr-\u65b9\u6cd5\u8bf4\u660e"},"xhr \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const xhr = new XMLHttpRequest()\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.open"),"\u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.open()\n/*\u521d\u59cb\u5316\u4e00\u4e2a\u8bf7\u6c42\u3002\u8be5\u65b9\u6cd5\u8981\u4ece javascript \u4ee3\u7801\u4f7f\u7528\n\u4ece\u539f\u751f\u4ee3\u7801\u521d\u59cb\u5316\u4e00\u4e2a\u8bf7\u6c42\uff0c\u4f7f\u7528 openRequest() \u66ff\u4ee3\n\u4e3a\u5df2\u6fc0\u6d3b\u7684\u8bf7\u6c42\u8c03\u7528 xhr.open()\uff0c\u6216\u8005 xhr.open() | openRequest() \u5df2\u88ab\u8c03\u7528\uff0c\u76f8\u5f53\u4e8e\u8c03\u7528abort()\n*/\n")),(0,a.kt)("p",null,"\u8bed\u6cd5\uff1axhr.open(method, url, async, user, password)"),(0,a.kt)("p",null,"\u53c2\u6570\u8bf4\u660e\uff1a"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"center"},(0,a.kt)("strong",{parentName:"th"},"\u53c2\u6570")),(0,a.kt)("th",{parentName:"tr",align:"left"},"\u53c2\u6570\u8bf4\u660e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"method"),(0,a.kt)("td",{parentName:"tr",align:"left"},"\u8981\u4f7f\u7528\u7684 HTTP \u65b9\u6cd5\uff0c\u6bd4\u5982 GET\u3001POST\u3001PUT\u3001DELETE\u3001\u7b49\u3002\u5bf9\u4e8e\u975e HTTP(S) URL \u88ab\u5ffd\u7565")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"url"),(0,a.kt)("td",{parentName:"tr",align:"left"},"\u53d1\u9001\u8bf7\u6c42\u7684 URL")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("em",{parentName:"td"},"async(\u53ef\u9009)")),(0,a.kt)("td",{parentName:"tr",align:"left"},"\u53ef\u9009\u7684\u5e03\u5c14\u53c2\u6570\uff0c\u9ed8\u8ba4\u4e3a true\uff0c\u8868\u793a\u662f\u5426\u5f02\u6b65\u6267\u884c\u64cd\u4f5c\uff0c\u5982\u679c true\uff0c\u5df2\u5b8c\u6210\u4e8b\u52a1\u7684\u901a\u77e5\u53ef\u4f9b\u4e8b\u4ef6\u76d1\u542c\u5668\u4f7f\u7528\uff0c\u5982\u679c multipart \u5c5e\u6027\u4e3a true \u5219\u8fd9\u4e2a\u5fc5\u987b\u4e3a true\uff0c\u5426\u5219\u5c06\u5f15\u53d1\u5f02\u5e38\uff0c\u5982\u679c\u503c\u4e3a false\uff0cxhr.send() \u65b9\u6cd5\u76f4\u5230\u6536\u5230\u7b54\u590d\u524d\u4e0d\u4f1a\u8fd4\u56de")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("strong",{parentName:"td"},"user(\u53ef\u9009)")),(0,a.kt)("td",{parentName:"tr",align:"left"},"\u53ef\u9009\u7528\u6237\u540d\uff0c\u53ef\u7528\u4e8e\u8ba4\u8bc1\uff1b\u9ed8\u8ba4\u4e3a null")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"password(\u53ef\u9009)"),(0,a.kt)("td",{parentName:"tr",align:"left"},"\u53ef\u9009\u7684\u5bc6\u7801\uff0c\u53ef\u7528\u4e8e\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u4e3a null")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.abort()")," \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.abort()\n/* \u5982\u679c\u8be5\u8bf7\u6c42\u5df2\u88ab\u53d1\u51fa\uff0c\u4f7f\u7528 xhr.abort() \u65b9\u6cd5\u5c06\u7ec8\u6b62\u8be5\u8bf7\u6c42\n\u5f53\u4e00\u4e2a\u8bf7\u6c42\u88ab\u7ec8\u6b62\u65f6\uff0c\u5b83\u7684 xhr.readyState \u5c06\u88ab\u7f6e\u4e3a XMLHttpRequest.UNSENT (0)\n\u5e76\u4e14\u8bf7\u6c42\u7684 status \u4e5f\u7f6e\u4e3a 0\n*/\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"let xhr;\nlet btnLogin = document.getElementById('btn-login')\nbtnLogin.addEventListener('click', () => {\n xhr ? xhr.abort() : loginApi\n})\n\nfunction loginApi() {\n const xhr = new XMLHttpRequest()\n xhr.open('GET','http://xxx.com/api/login', true)\n xhr.onloadend = function() {\n  xhr = null\n }\n xhr.send(null)\n return xhr\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.send()")," \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/send"},"XMLHttpRequest.send()"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.send()\n/* \u7528\u4e8e\u53d1\u9001 HTTP \u8bf7\u6c42\n\u5982\u679c\u662f\u5f02\u6b65\u8bf7\u6c42\uff08\u9ed8\u8ba4\u4e3a\u5f02\u6b65\u8bf7\u6c42\uff09\uff0c\u5219\u6b64\u65b9\u6cd5\u4f1a\u5728\u8bf7\u6c42\u53d1\u9001\u540e\u7acb\u5373\u8fd4\u56de\n\u5982\u679c\u662f\u540c\u6b65\u8bf7\u6c42\uff0c\u5219\u6b64\u65b9\u6cd5\u76f4\u5230\u54cd\u5e94\u5230\u8fbe\u540e\u624d\u4f1a\u8fd4\u56de\n\u5982\u679c\u6ca1\u6709\u4f7f\u7528 setRequestHeader() \u65b9\u6cd5\u8bbe\u7f6e Accept \u5934\u90e8\u4fe1\u606f\uff0c\u5219\u4f1a\u53d1\u9001\u5e26\u6709 "*/*" \u7684 Accept \u5934\u90e8\nxhr.send() \u65b9\u6cd5\u63a5\u53d7\u4e00\u4e2a\u53ef\u9009\u7684\u53c2\u6570\uff0c\u5176\u4f5c\u4e3a\u8bf7\u6c42\u4e3b\u4f53\uff1b\u5982\u679c\u8bf7\u6c42\u65b9\u6cd5\u662f GET \u6216\u8005 HEAD\uff0c\u5219\u5e94\u5c06\u8bf7\u6c42\u4e3b\u4f53\u8bbe\u7f6e\u4e3a null\n\u6ce8\u610f\uff1a\n\u4e0d\u8981\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684 ArrayBuffer \u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0cArrayBuffer \u5df2\u7ecf\u4e0d\u518d\u662f AJAX \u89c4\u8303\u7684\u4e00\u90e8\u5206\uff0c\u8bf7\u6539\u7528 ArrayBufferView\n*/\n')),(0,a.kt)("p",null,"\u8bed\u6cd5\uff1a\nXMLHttpRequest.send(body)"),(0,a.kt)("p",null,"\u53c2\u6570\u8bf4\u660e"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570\u8bf4\u660e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"body\u6570\u636e\u8bf7\u6c42\u4f53"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5728 XHR \u8bf7\u6c42\u4e2d\u8981\u53d1\u9001\u7684\u6570\u636e\u4f53\uff0c\u53ef\u4ee5\u662f\uff1a1 \u53ef\u4ee5\u4e3a Document, \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u5728\u53d1\u9001\u4e4b\u524d\u88ab\u5e8f\u5217\u5316 2 \u4e3a XMLHttpRequestBodyInit\uff0c\u53ef\u4ee5\u662f Blob, BufferSource, FormData, URLSearchParams, \u6216\u8005 USVString \u5bf9\u8c61")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.setRequestHeader()")," \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Forbidden_header_name"},"\u7981\u6b62\u4fee\u6539\u7684\u8bf7\u6c42\u5934")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Forbidden_response_header_name"},"\u7981\u6b62\u4fee\u6539\u7684\u54cd\u5e94\u5934"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.setRequestHeader()\n/*\u8bbe\u7f6e HTTP \u8bf7\u6c42\u5934\u90e8\u7684\u65b9\u6cd5\n\u6b64\u65b9\u6cd5\u5fc5\u987b\u5728 xhr.open() \u65b9\u6cd5\u548c xhr.send() \u4e4b\u95f4\u8c03\u7528\n\u5982\u679c\u591a\u6b21\u5bf9\u540c\u4e00\u4e2a\u8bf7\u6c42\u5934\u8d4b\u503c\uff0c\u53ea\u4f1a\u751f\u6210\u4e00\u4e2a\u5408\u5e76\u4e86\u591a\u4e2a\u503c\u7684\u8bf7\u6c42\u5934\n\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e Accept \u5c5e\u6027\uff0c\u5219\u6b64\u53d1\u9001\u51fa xhr.send() \u7684\u503c\u4e3a\u6b64\u5c5e\u6027\u7684\u9ed8\u8ba4\u503c\uff1a*/*\n\n\u5b89\u5168\u8d77\u89c1\uff0c\u6709\u4e9b\u8bf7\u6c42\u5934\u7684\u503c\u53ea\u80fd\u7531 user agent \u8bbe\u7f6e: \u7981\u6b62\u4fee\u6539\u7684\u8bf7\u6c42\u5934 \u548c \u7981\u6b62\u4fee\u6539\u7684\u54cd\u5e94\u5934\n\n\u4e00\u4e9b\u81ea\u5b9a\u4e49 header \u5c5e\u6027\u8fdb\u884c\u8de8\u57df\u8bf7\u6c42\u65f6\n\u53ef\u80fd\u4f1a\u9047\u5230 "not allowed by Access-Control-Allow-Headers in preflight response"\n\u53ef\u80fd\u9700\u8981\u5728\u4f60\u7684\u670d\u52a1\u7aef\u8bbe\u7f6e "Access-Control-Allow-Headers"\n\u5982\uff1apost \u8bf7\u6c42\u4e2d header \u643a\u5e26 token\n*/\n')),(0,a.kt)("p",null,"\u8bed\u6cd5\uff1a\nxhr.setRequestHeader(header, value)"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570\u8bf4\u660e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"header"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5c5e\u6027\u7684\u540d\u79f0")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"value"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5c5e\u6027\u503c")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.getResponseHeader()")," \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.getResponseHeader()\n/*\u8fd4\u56de\u5305\u542b\u6307\u5b9a\u54cd\u5e94\u5934\u6587\u672c\u7684\u5b57\u7b26\u4e32\n\u5982\u679c\u5728\u8fd4\u56de\u7684\u54cd\u5e94\u5934\u4e2d\u6709\u591a\u4e2a\u4e00\u6837\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u503c\u5c31\u4f1a\u662f\u7528\u9017\u53f7\u548c\u7a7a\u683c\u5c06\u503c\u5206\u9694\u7684\u5b57\u7b26\u4e32\ngetResponseHeader() \u65b9\u6cd5\u4ee5 UTF \u7f16\u7801\u8fd4\u56de\u503c\u3002\u641c\u7d22\u7684\u62a5\u6587\u540d\u662f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\n*/\n")),(0,a.kt)("p",null,"\u8bed\u6cd5\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var useHeader = xhr.getResponseHeader(name)\n")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570\u8bf4\u660e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"name"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u8981\u8fd4\u56de\u7684\u62a5\u6587\u540d\u79f0")))),(0,a.kt)("p",null,"\u8fd4\u56de\u503c\uff1a\n\u62a5\u6587\u503c\uff0c\u5982\u679c\u8fde\u63a5\u672a\u5b8c\u6210\uff0c\u54cd\u5e94\u4e2d\u4e0d\u5b58\u5728\u62a5\u6587\u540d\u79f0\uff0c\u6216\u8005\u88ab W3C \u9650\u5236\uff0c\u5219\u8fd4\u56de null"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const allowHeader = \'xxx\'\nconst xhr = new XMLHttpRequest()\nxhr.open("GET", "somefile.txt", true)\n\nxhr.onreadystatechange = function() {\n  if(this.readyState == this.HEADERS_RECEIVED) { // \u5982\u679c readyState \u8868\u793a\u54cd\u5e94\u5934\u5df2\u8fd4\u56de\n  // \u83b7\u53d6\u8bf7\u6c42\uff0c\u54cd\u5e94\u5934\u7684 Content-Type\n    const contentType = xhr.getResponseHeader("Content-Type")\n    if(contentType != allowHeader) { // \u8bbe\u7f6e\u7684\u9884\u671f\u503c\n      xhr.abort() // \u7ec8\u6b62\u8bf7\u6c42\n    }\n  }\n}\n\nxhr.send()\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.getAllResponseHeaders()")," \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.getAllResponseHeaders()\n/*\u8fd4\u56de\u6240\u6709\u7684\u54cd\u5e94\u5934\n\u4ee5 CRLF \u5206\u5272\u7684\u5b57\u7b26\u4e32\uff0c\u6216\u8005 null \u5982\u679c\u6ca1\u6709\u6536\u5230\u4efb\u4f55\u54cd\u5e94\n\u6ce8\u610f\uff1a \u5bf9\u4e8e\u590d\u5408\u8bf7\u6c42\uff08 multipart requests \uff09\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u5f53\u524d\u8bf7\u6c42\u7684\u5934\u90e8\uff0c\u800c\u4e0d\u662f\u6700\u521d\u7684\u8bf7\u6c42\u7684\u5934\u90e8\n*/\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"CR = Carriage Return\uff0c\u56de\u8f66\u7b26\u53f7\uff08\\r\uff0c\u5341\u516d\u8fdb\u5236 ascii \u7801\u4e3a 0x0D\uff0c\u5341\u8fdb\u5236 ascii \u7801\u4e3a 13\uff09\uff0c\u7528\u4e8e\u5c06\u9f20\u6807\u79fb\u52a8\u5230\u884c\u9996\uff0c\u5e76\u4e0d\u524d\u8fdb\u81f3\u4e0b\u4e00\u884c"),(0,a.kt)("li",{parentName:"ul"},"LF = Line Feed\uff0c\u6362\u884c\u7b26\u53f7\uff08 \\n, \u5341\u516d\u8fdb\u5236 ascii \u7801\u4e3a 0x0A\uff0c\u5341\u8fdb\u5236 ascii \u7801\u4e3a 10\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u7d27\u90bb\u7684 CR \u548c LF\uff08\u7ec4\u6210 CRLF\uff0c\\r\\n\uff0c\u6216\u5341\u516d\u8fdb\u5236 0x0D0A\uff09\u5c06\u9f20\u6807\u79fb\u52a8\u5230\u4e0b\u4e00\u884c\u884c\u9996")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"/*\n// \u8fd4\u56de\u7684 headers\naccept-ranges: bytes\\r\\n\ncache-control: public, max-age=0\\r\\n\nconnection: keep-alive\\r\\n\ncontent-length: 91493962\\r\\n\ncontent-type: application/zip\\r\\n\ndate: Tue, 28 Jun 2022 02:02:57 GMT\\r\\n\netag: W/\"574164a-17c9d0f4e79\"\\r\\n\nkeep-alive: timeout=5\\r\\n\nlast-modified: Wed, 20 Oct 2021 09:36:38 GMT\\r\\n\nx-powered-by: Express\\r\\n\nx-sent: true\\r\\n\nx-timestamp: 1656381777073\\r\\n\n*/\nconst xhr = new XMLHttpRequest()\nxhr.open('GET', './source/test-10M.zip', true)\nxhr.addEventListener('load', () => {\n const headersMap = {}\n const allHeaders = xhr.getAllResponseHeaders()\n console.log(allHeaders)\n const headersArr = allHeaders.trim().split(/[\\r\\n]+/)\n console.log(headersArr)\n headersArr.forEach(item => {\n  const connectStr = ': '\n  const parts = item.split(connectStr)\n  const header = parts.shift() // \u5220\u9664\u6570\u7ec4\u7b2c\u4e00\u9879\uff0c\u8fd4\u56de\u7b2c\u4e00\u9879\u7684\u503c\uff0c\u4f1a\u6539\u53d8\u539f\u6570\u7ec4\n  headersMap[header] = parts.join('')\n })\n console.log(headersMap)\n console.log('Content-Type:' + headersMap['content-type'])\n})\nxhr.send()\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.overrideMimeType()")," \u65b9\u6cd5\u8bf4\u660e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.iana.org/assignments/media-types/media-types.xhtml"},"MIME Type\u53c2\u7167\u8868"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'xhr.overrideMimeType(mimeType)\n/*\u6307\u5b9a\u4e00\u4e2a MIME \u7c7b\u578b\u7528\u4e8e\u66ff\u4ee3\u670d\u52a1\u5668\u6307\u5b9a\u7684\u7c7b\u578b\uff0c\u4f7f\u670d\u52a1\u7aef\u54cd\u5e94\u4fe1\u606f\u4e2d\u4f20\u8f93\u7684\u6570\u636e\u6309\u7167\u8be5\u6307\u5b9a MIME \u7c7b\u578b\u5904\u7406\n\u4f8b\u5982\u5f3a\u5236\u4f7f\u6d41\u65b9\u5f0f\u5904\u7406\u4e3a"text/xml"\u7c7b\u578b\u5904\u7406\u65f6\u4f1a\u88ab\u4f7f\u7528\u5230\uff0c\u5373\u4f7f\u670d\u52a1\u5668\u5728\u54cd\u5e94\u5934\u4e2d\u5e76\u6ca1\u6709\u8fd9\u6837\u6307\u5b9a\n\u6b64\u65b9\u6cd5\u5fc5\u987b\u5728 xhr.send() \u65b9\u6cd5\u4e4b\u524d\u8c03\u7528\u65b9\u4e3a\u6709\u6548\n\n\u5982\u679c\u670d\u52a1\u5668\u6ca1\u6709\u6307\u5b9a\u4e00\u4e2a Content-Type \u5934\uff0cXMLHttpRequest \u9ed8\u8ba4 MIME \u7c7b\u578b\u4e3a"text/xml"\n\u5982\u679c\u63a5\u53d7\u7684\u6570\u636e\u4e0d\u662f\u6709\u6548\u7684 XML\uff0c\u5c06\u4f1a\u51fa\u73b0\u683c\u201d\u683c\u5f0f\u4e0d\u6b63\u786e\u201c\u7684\u9519\u8bef\n\u901a\u8fc7\u8c03\u7528 overrideMimeType() \u6307\u5b9a\u5404\u79cd\u7c7b\u578b\u6765\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\n*/\n')),(0,a.kt)("p",null,"\u8bed\u6cd5\uff1a\nxhr.overrideMimeType(mimeType)"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570\u8bf4\u660e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"mimeType"),(0,a.kt)("td",{parentName:"tr",align:null},'\u6307\u5b9a\u5177\u4f53\u7684 MIME \u7c7b\u578b\u53bb\u4ee3\u66ff\u6709\u670d\u52a1\u5668\u6307\u5b9a\u7684 MIME \u7c7b\u578b. \u5982\u679c\u670d\u52a1\u5668\u6ca1\u6709\u6307\u5b9a\u7c7b\u578b\uff0c\u90a3\u4e48 xhr \u5c06\u4f1a\u9ed8\u8ba4\u4e3a "text/xml"')))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"xhr.msCachingEnabled()")," \u65b9\u6cd5\u8bf4\u660e\n\u8fd9\u4e2a\u662f\u4e00\u4e2a \u975e\u6807\u51c6\u5c5e\u6027\u65b9\u6cd5\uff0c\u4e0d\u8981\u5728\u7ad9\u70b9\u4e0a\u4f7f\u7528\u5b83"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"xhr.msCachingEnabled()\n/*\u83b7\u53d6 XMLHttpRequest \u7684\u5f53\u524d\u7f13\u5b58\u72b6\u6001\n\u6d4f\u89c8\u5668\u517c\u5bb9\u6027\uff0c\u6b64\u4e13\u6709\u65b9\u6cd5\u7279\u5b9a\u4e8e IE\n\u8fd4\u56de\u503c\uff1a\u5e03\u5c14\u503c\n\u5982\u679c\u4e3a true\uff0c\u5219 XMLHttpRequest \u88ab\u7f13\u5b58\u5230\u78c1\u76d8\n\u5982\u679c\u4e3a false\uff0c\u5219\u4e0d\u5199\u5165\u78c1\u76d8\n*/\n")),(0,a.kt)("h3",{id:"\u4e8b\u4ef6\u5904\u7406\u5668"},"\u4e8b\u4ef6\u5904\u7406\u5668"),(0,a.kt)("p",null,"\u4f5c\u4e3a XMLHttpRequest \u5b9e\u4f8b\u7684\u5c5e\u6027\u4e4b\u4e00\uff0c\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u652f\u6301 onreadystatechange\uff0c\n\u53ef\u4ee5\u4f7f\u7528 xhr.onload \u8fdb\u884c\u4e8b\u4ef6\u7684\u76d1\u542c\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4f9b\u6807\u51c6\u7684\u76d1\u542c\u5668 xhr.addEventListener('load', fn, false) \u6765\u76d1\u542c"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"center"},"\u4e8b\u4ef6\u540d\u79f0"),(0,a.kt)("th",{parentName:"tr",align:"center"},"\u4e8b\u4ef6\u4f5c\u7528"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onabort"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u5f53\u8bf7\u6c42\u505c\u6b62\u65f6\u89e6\u53d1\uff0c\u5982\u8c03\u7528 xhr.abort()")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onerror"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u5f53\u8bf7\u6c42\u9047\u5230\u9519\u8bef\u65f6\u89e6\u53d1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onloadstart"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u5f53\u7a0b\u5e8f\u5f00\u59cb\u52a0\u8f7d\u65f6\uff0cloadstart \u4e8b\u4ef6\u5c06\u88ab\u89e6\u53d1\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u53ef\u4ee5\u88ab xhr \u8c03\u7528\uff0c\u4e5f\u9002\u7528\u4e8e img \u548c video \u5143\u7d20")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onload"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u5f53\u4e00\u4e2a xhr \u8bf7\u6c42\u5b8c\u6210\u7684\u65f6\u5019\u4f1a\u89e6\u53d1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onloadend"),(0,a.kt)("td",{parentName:"tr",align:"center"},"loadend \u4e8b\u4ef6\u603b\u662f\u5728\u4e00\u4e2a\u8d44\u6e90\u7684\u52a0\u8f7d\u8fdb\u5ea6\u505c\u6b62\u4e4b\u540e\u88ab\u89e6\u53d1 (\u4f8b\u5982\uff0c\u5728\u5df2\u7ecf\u89e6\u53d1 \u201cerror\u201d\uff0c\u201cabort\u201d \u6216 \u201cload\u201d \u4e8b\u4ef6\u4e4b\u540e)\u3002\u8fd9\u9002\u7528\u4e8e xhr \u8c03\u7528\uff0c\u4ee5\u53ca img \u6216 video \u4e4b\u7c7b\u5143\u7d20\u7684\u5185\u5bb9")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onprogress"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u5728\u8bf7\u6c42\u63a5\u6536\u5230\u6570\u636e\u7684\u65f6\u5019\u88ab\u5468\u671f\u6027\u89e6\u53d1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"onreadystatechange"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u53ea\u8981 readyState \u5c5e\u6027\u53d1\u751f\u53d8\u5316\uff0c\u5c31\u4f1a\u8c03\u7528\u76f8\u5e94\u7684\u5904\u7406\u51fd\u6570\uff0c\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\u4f1a\u88ab\u7528\u6237\u7ebf\u7a0b\u6240\u8c03\u7528\u3002xhr.onreadystatechange \u4f1a\u5728 xhr \u7684readyState \u5c5e\u6027\u53d1\u751f\u6539\u53d8\u65f6\u89e6\u53d1 readystatechange \u4e8b\u4ef6\u7684\u65f6\u5019\u88ab\u8c03\u7528")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"ontimeout"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u5f53\u4e00\u4e2a\u8bf7\u6c42\u8d85\u8fc7\u9884\u5b9a\u65f6\u95f4\u5230\u671f\u800c\u7ec8\u6b62\u65f6\uff0c\u4f1a\u89e6\u53d1 timeout \u4e8b\u4ef6")))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"/**\n * \u53ef\u4ee5\u7528 xhr.onreadystatechange = function() { ... } \u7684\u5199\u6cd5\n * \u53ef\u4ee5\u7528 xhr.onprogress = function() { ... } \u7684\u5199\u6cd5\n * xhr.addEventListener('readystatechange', () => {} \u4e0d\u5e26 on\n * xhr.addEventListener('progress', () => {} \u4e0d\u5e26 on\n * */\nconst xhr = new XMLHttpRequest()\nxhr.open('GET', './source/test-10M.zip', true)\nxhr.responseType = 'blob'\nconsole.log(xhr)\nconsole.log('reayState:' + xhr.readyState)\nxhr.addEventListener('readystatechange', () => { console.log('\u8bf7\u6c42\u54cd\u5e94\u72b6\u6001\u53d1\u751f\u53d8~reayState:' + xhr.readyState) })\nxhr.addEventListener('progress', () => { console.log('\u8bf7\u6c42\u63a5\u6536\u5230\u7684\u6570\u636e~') })\nxhr.addEventListener('timeout', () => { console.log('\u7f51\u7edc\u8bf7\u6c42\u8d85\u65f6~') })\nxhr.addEventListener('abort', () => { console.log('\u8bf7\u6c42\u4e2d\u6b62\u4e86~') })\nxhr.addEventListener('error', () => { console.log('\u8bf7\u6c42\u51fa\u9519\u4e86~') })\nxhr.addEventListener('loadstart', () => { console.log('\u8bf7\u6c42\u5f00\u59cb\u4e86~') })\nxhr.addEventListener('load', () => { console.log('\u8bf7\u6c42\u5b8c\u6210\u4e86~') })\nxhr.addEventListener('loadend', () => { console.log('\u8bf7\u6c42\u52a0\u8f7d\u8fdb\u5ea6\u505c\u6b62~') })\nxhr.send(null)\n")),(0,a.kt)("p",null,"\u5f53\u4e00\u4e2a XMLHttpRequest \u8bf7\u6c42\u88ab abort() \u65b9\u6cd5\u53d6\u6d88\u65f6\uff0c\u5176\u5bf9\u5e94\u7684 readystatechange \u4e8b\u4ef6\u4e0d\u4f1a\u88ab\u89e6\u53d1"))}m.isMDXComponent=!0}}]);